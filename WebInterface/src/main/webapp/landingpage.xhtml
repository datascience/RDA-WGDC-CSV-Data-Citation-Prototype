<!--
  ~ Copyright [2015] [Stefan PrÃ¶ll]
  ~
  ~    Licensed under the Apache License, Version 2.0 (the "License");
  ~    you may not use this file except in compliance with the License.
  ~    You may obtain a copy of the License at
  ~
  ~        http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~    Unless required by applicable law or agreed to in writing, software
  ~    distributed under the License is distributed on an "AS IS" BASIS,
  ~    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~    See the License for the specific language governing permissions and
  ~    limitations under the License.
  -->

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
        >

<h:head>

    <style type="text/css">
        .column1{width: 20%;height:auto}
        .column2{width: 75%;height:auto}

    </style>

</h:head>

<h:body>
    <div id="containerId" class="container">

    <!-- BEGIN user management -->
    <div>
        <!-- BEGIN user management -->
        <ui:include src="/topmenu.xhtml"/>
        <!-- END user management -->
    </div>
    <!-- END user management -->

        <f:metadata>
            <f:viewParam name="requestPID" value="#{landingPageBean.requestPID}"/>
            <f:viewAction action="#{landingPageBean.initPidRequest}"/>
        </f:metadata>

        <h:form id="remoteCommandForm">
            <p:remoteCommand name="loadPage" actionListener="#{landingPageBean.loadData}" autoRun="true"/>
        </h:form>

        <h1>Landing Pages</h1>
        <h:form id="landingForm">
            <p:panel header="Select a Superset and its subset" style="width: 1024;">
                <h:panelGrid columns="2" cellpadding="10">


                    <h:outputText value="Superset"/>
                    <p:selectOneMenu value="#{landingPageBean.selectedBaseTable}">
                        <f:selectItems value="#{landingPageBean.availableBaseTables}"/>

                        <p:ajax update="subsetId" listener="#{landingPageBean.handleDropDownChangeBaseTables}"/>
                    </p:selectOneMenu>

                    <h:outputText value="Subset"/>
                    <p:selectOneMenu value="#{landingPageBean.selectedSubset}" id="subsetId">
                        <f:selectItems value="#{landingPageBean.availableSubsets}"/>
                        <p:ajax update=":metadataForm" listener="#{landingPageBean.handleDropDownChangeSubsets}"/>
                    </p:selectOneMenu>

                    <p:commandButton id="landingButton" action="#{landingPageBean.handleDropDownChangeSubsets}"
                                     value="Retrieve data" update=":metadataForm"></p:commandButton>


                </h:panelGrid>

            </p:panel>
        </h:form>

        <h:form id="metadataForm">
            <p:panel header="Landing Pages - Dataset Metadata" style="width: 1024px;">
                <h:panelGrid columns="2" cellpadding="10" columnClasses="column1,column2" style="width: 100%">

                    <h:outputText value="Dataset PID"/>
                    <h:outputText value="#{landingPageBean.metaPid}"/>
                    <h:outputText value="Dataset author"/>
                    <h:outputText value="#{landingPageBean.metaAuthor}"/>
                    <h:outputText value="Database PID"/>
                    <h:outputText value="#{landingPageBean.metaParentPid}"/>
                    <h:outputText value="Database upload timestamp"/>
                    <h:outputText value="#{landingPageBean.metaParentUploadTimestamp}"/>
                    <h:outputText value="Parent data author"/>
                    <h:outputText value="#{landingPageBean.metaParentAuthor}"/>
                    <h:outputText value="Execution timestamp"/>
                    <h:outputText value="#{landingPageBean.metaExecutionDate}"/>
                    <h:outputText value="Resultset hash"/>
                    <h:outputText value="#{landingPageBean.metaResultSetHash}"/>
                    <h:outputText value="Query hash"/>
                    <h:outputText value="#{landingPageBean.metaQueryHash}"/>
                    <h:outputText value="Description"/>

                    <p:inputTextarea
                            value="#{landingPageBean.metaDescription}"
                            styleClass="no-border" readonly="true" style="width:80%">

                    </p:inputTextarea>


                    <h:outputText value="SQL string"/>
                    <p:inputTextarea
                            value="#{landingPageBean.metaSQLString}"
                            styleClass="no-border" readonly="true" style="width:80%"

                            rows="#{landingPageBean.countChar(landingPageBean.metaSQLString)+2}"/>


                    <p:spacer></p:spacer>
                    <p:separator/>
                    <h:outputText value="Suggested citation text:"/>
                    <h:outputText value="#{landingPageBean.metaSuggestedCitationString}"/>

                </h:panelGrid>

            </p:panel>
        </h:form>

    </div>
</h:body>
</html>
